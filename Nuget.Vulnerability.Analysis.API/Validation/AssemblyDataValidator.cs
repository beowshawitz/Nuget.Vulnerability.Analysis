using FluentValidation;
using Nuget.Vulnerability.Analysis.Core.Inbound;

namespace Nuget.Vulnerability.Analysis.API.Validation;

public class AssemblyDataValidator : AbstractValidator<AssemblyData>
{
	public AssemblyDataValidator()
	{
		RuleFor(x => x.Name)
			.NotEmpty();

		RuleFor(x => x.Version)
			.MinimumLength(3)
			.NotEmpty()
			.Matches("^(\\d+\\.)?(\\d+\\.)?(\\*|\\d+)$");
	}
}

